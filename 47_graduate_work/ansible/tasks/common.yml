---

- name: Common setup for CentOS nodes
  block:

  - name: Set time zone
    ansible.builtin.copy:
      remote_src: True
      src: /usr/share/zoneinfo/Europe/Moscow
      dest: /etc/localtime
      owner: root
      group: root
      mode: '0644'

  - name: Restart service cron on centos
    ansible.builtin.systemd:
      state: restarted
      daemon_reload: true
      name: crond

  - name: Put SELinux in permissive mode.
    ansible.posix.selinux:
      policy: targeted
      state: permissive
    when: inventory_hostname != 'inetRouter'

  - name: Disable Portmapper service
    ansible.builtin.service:
      name: rpcbind
      enabled: false
      state: stopped

  when: ansible_facts.distribution == 'CentOS'

- name: Common setup for Ubuntu nodes
  block:

  - name: Set time zone
    ansible.builtin.command: timedatectl set-timezone Europe/Moscow

  - name: Reconfigure Timezone Data
    ansible.builtin.command: dpkg-reconfigure -f noninteractive tzdata

  when: ansible_facts.distribution == 'Ubuntu'
